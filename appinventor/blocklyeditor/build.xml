<?xml version="1.0"?>

<!-- ======================================================================
     Copyright 2012 Google Inc.  All Rights Reserved.
     Author: sharon@google.com (Sharon Perl)

     Blockly-based blocks editor
     ====================================================================== -->

<project name="blocklyeditor" default="all">
  <description>
    In-browser blocks editor for App Inventor based on Blockly
  </description>

  <target name="all"
          depends="BlocklyCompile">
  </target>

  <!-- =====================================================================
       Import common directory, task, and target definitions.
       ===================================================================== -->
  <import file="../build-common.xml" />

  <property name="blockly.src.dir" location="${lib.dir}/blockly/src" />

  <target name="BlocklyCompile"
          description="For now, compiling the Blockly editor means cat-ing its javascript together with the relevant javascript in the Blockly library">
    <!-- blockly.js has to come first -->
    <concat destfile="${public.build.dir}/blockly-all.js">
      <fileset file="${blockly.src.dir}/blockly.js"/>
    </concat>
    <!-- the rest of the blockly .js files can come in any order -->
    <concat destfile="${public.build.dir}/blockly-all.js"
            append="true">
      <fileset dir="${blockly.src.dir}">
        <include name="*.js"/>
        <exclude name="blockly.js"/>
        <include name="language/language_*.js"/>
        <exclude name="language/language_docs.js"/>
      </fileset>
    </concat>
    <!-- finally, include any of our own .js file in any order -->
    <concat destfile="${public.build.dir}/blockly-all.js"
            append="true">
      <fileset dir="${src.dir}">
        <include name="*.js"/>
      </fileset>
    </concat>
  </target>
</project>
